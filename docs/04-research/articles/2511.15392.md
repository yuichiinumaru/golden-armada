# Arxiv Analysis: DEPO: Dual-Efficiency Preference Optimization for LLM Agents

**ID:** 2511.15392
**Date:** 2025-11-19
**Link:** https://arxiv.org/html/2511.15392

## 1. Executive Summary
DEPO addresses the inefficiency of LLM agents, defining "Dual-Efficiency": **Step-Level** (tokens per step) and **Trajectory-Level** (total steps). It proposes a preference optimization algorithm (based on KTO) that adds an **Efficiency Bonus** to the reward function for successful trajectories that are concise. This encourages the model to be brief and direct, reducing token usage by ~60% without hurting performance.

## 2. Detailed Key Concepts

### 2.1. Dual-Efficiency Metrics
-   $T_{token}$: Average tokens generated per step. High = Verbose/Overthinking.
-   $T_{step}$: Total steps to finish task. High = Wandering/Inefficient planning.

### 2.2. DEPO Algorithm
-   **Base:** KTO (Kahneman-Tversky Optimization), which learns from unpaired "good" and "bad" examples.
-   **Bonus:** For "good" trajectories, add a bonus $b(\tau) = \frac{\alpha_1}{T_{token}} + \frac{\alpha_2}{T_{step}}$.
-   **Effect:** The model learns that "Good" isn't just "Success", it's "Fast Success".

## 3. Gap Analysis

| Feature/Concept | Current CodeSwarm | Gap |
| :--- | :--- | :--- |
| **Efficiency Metrics** | None | **High:** We don't track tokens/step or steps/task as KPIs. We only track "Success". |
| **Conciseness Training** | Prompting only | **Medium:** We rely on prompts like "Be concise". DEPO suggests fine-tuning or strong reward signals are better. |
| **Trajectory Optimization** | None | **High:** We don't penalize agents for taking 20 steps to do a 5-step task. |

## 4. Implementation Plan (Agno + SurrealDB + Gemini)

### Phase 1: Efficiency Logging
-   **Action:** Update `event_logger.py` to record:
    -   `token_count` for each LLM response.
    -   `step_count` for each task.
-   **Dashboard:** Visualize "Average Cost per Task" in a dashboard.

### Phase 2: The "Efficiency Critic" (Prompt-Based DEPO)
-   **Action:** Add a `CriticAgent` that reviews task logs.
-   **Prompt:** "This task took 15 steps. Here is the log. Could it be done in 5? If yes, rewrite the plan."
-   **Feedback:** Feed this "Optimized Plan" back into the Knowledge Base as a "Gold Standard" (Self-Improvement).

### Phase 3: Budget Constraints
-   **Action:** Give agents a "Token Budget" and "Step Budget". If they exceed it, they must stop and "Reflect" (ask for help or simplify).
